"use strict";!function(t,n){t.langs=["ru","en"],t.messages={ajax_fail:{ru:"Что-то пошло не так, перезагрузите страницу и попробуйте снова",en:"Something went wrong, reload the page and try again"},alert:{ru:"Уведомление",en:"Alert"}},t.ajax=!0,t.getLang=function(){var n=location.pathname,e=n.split("/");return e=e[1],t.in_array(e,t.langs)?e:t.langs[0]},t.getMessage=function(e){var a=t.getLang(),r=t.messages[e][a];return r!==n?r:""},t.addMessage=function(n){for(var e in n)t.messages[e]=n[e]},t.checkFileSize=function(t,n){try{n=n||5,t instanceof jQuery&&(t=t[0]);var e=t.files[0],a=e.size;return a<=1024*n*1024}catch(t){return!0}},t.imgload=function(t,n){var e=[];if(n=n||function(){},"string"==typeof t){var a=[];a.push(t),t=a}t instanceof jQuery?t.each(function(){var t=$(this),n=t.attr("src");""!=$.trim(n)&&e.push(n)}):t instanceof Array&&(e=t);var r=0,o=e.length;if(o)for(var i=0;i<o;i++){var u=new Image;u.onload=function(){++r==o&&n()},u.src=e[i]}else setTimeout(function(){n()},100)},t.alert=function(n,e,a){a=a||function(){},e=e||t.getMessage("alert");var r=300;$(".popup__title").html(e),$(".popup__msg").html(n),$(".popup").fadeIn(r),$(".popup__cross, .popup__bg").unbind("click").on("click",function(){$(".popup").fadeOut(r,function(){a()})})},t.get=function(e,a,r,o){r=r||"text",o=o||function(){alert(t.getMessage("ajax_fail"))},1==t.ajax&&(t.ajax=!1,$.get(e,function(e){t.ajax=!0,a!==n&&a(e)},r).fail(function(){t.ajax=!0,o!==n&&o()}))},t.post=function(e,a,r,o,i){o=o||"text",i=i||function(){alert(t.getMessage("ajax_fail"))},1==t.ajax&&(t.ajax=!1,$.post(e,a,function(e){t.ajax=!0,r!==n&&r(e)},o).fail(function(){t.ajax=!0,i!==n&&i()}))},t.scrollY=function(){return window.scrollY||document.documentElement.scrollTop},t.number_format=function(t,n,e,a){var r,o,i,u,c,f="";return t<0&&(f="-",t*=-1),isNaN(n=Math.abs(n))&&(n=0),e=e||".",a=a||" ",r=parseInt(t=(+t||0).toFixed(n))+"",(o=r.length)>3?o%=3:o=0,c=o?r.substr(0,o)+a:"",i=r.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+a),u=n?e+Math.abs(t-r).toFixed(n).replace(/-/,0).slice(2):"",f+c+i+u},t.strip_tags=function(t,n){return n=n||"",t.replace(/<\/?[^>]+>/gi,n)},t.fmod=function(n,e){var a;a=t.count_char_after_dot(n)>t.count_char_after_dot(e)?t.count_char_after_dot(n):t.count_char_after_dot(e);var r=Math.pow(10,a);return n*=r,e*=r,(n-Math.floor(n/e)*e)/r},t.count_char_after_dot=function(t){for(var n=0;t-Math.floor(t)!=0;)n++,t*=10;return n},t.noScreening=function(t){if(t.length>0){var n=t.html();n=n.replace(new RegExp("&lt;","g"),"<").replace(new RegExp("&gt;","g"),">").replace(new RegExp("&amp;","g"),"&").replace(new RegExp("&quot;","g"),'"'),t.html(n)}},t.array_unique=function(t){for(var n={},e=0,a=t.length;e<a;e++)n[t[e]]=t[e];t=[];for(var e in n)t.push(e);return t},t.in_array=function(t,n,e){e=e||!1;for(var a=0,r=n.length;a<r;a++)if(0==e){if(n[a]==t)return!0}else if(n[a]===t)return!0;return!1},t.decl=function(n,e,a,r){var o={1:e,2:a,5:r};return o[t.getDeclNum(n)]},t.getDeclNum=function(t){var n=t%100,e=t%10;return n>10&&n<20?5:1==e?1:e>=2&&e<=4?2:5},t.getUrlVar=function(){var t=[],n=[],e={},a=location.search;if(""!=a){t=a.substr(1).split("&");for(var r=0;r<t.length;r++)n=t[r].split("="),e[n[0]]=n[1]}return e},t.getUrlHash=function(){var t=[],n=[],e={},a=location.hash;if(""!=a){t=a.substr(1).split("&");for(var r=0;r<t.length;r++)n=t[r].split("="),e[n[0]]=n[1]}return e},t.getUrl=function(t){var e=location.pathname.split("/");return e.shift(),t!==n?e[t]:e},t.parseInt=function(t){return parseInt(t,10)}}(window.my=window.my||{});
"use strict";function window_resize(){var i=$(window),w=$("body");window.ww=i.width(),window.wh=i.height(),$("#page-wrapper").css({minHeight:wh-parseInt(w.css("margin-top"),10)})}$(document).ready(function(){window_resize()}),$(window).resize(function(){window_resize()});
"use strict";jQuery.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).ready(function(){var e=$("#shake_message");e.length&&e.modal("show"),$(".js_delete_confirm").on("click",function(){if(!confirm("Вы точно хотите удалить запись?"))return!1})});
"use strict";$(document).ready(function(){function e(e){return e=e.split("."),e=e[e.length-1],e=e.toLowerCase()}$(".drop__file_list").sortable({containerSelector:".drop__file_list",itemSelector:".drop__file_item",vertical:!1,pullPlaceholder:!0,placeholder:'<div class="drop__file_item drop__file_item--placeholder"></div>',bodyClass:"",onDrop:function(e,t,o,r){e.removeClass(t.group.options.draggedClass).removeAttr("style"),$("body").removeClass(t.group.options.bodyClass);var a={item_id:e.attr("data-id"),left_item_id:e.prev().attr("data-id")};$.post("/admin/ajax/move",a,function(e){},"json").fail(function(){alert("Произошла ошибка, сортировка не применилась")})},handle:"a"}),window.files_count=0,window.upload_count=0;var t=["png","jpg","jpeg","bmp","rar","tar","zip","gzip","pdf","mp3","doc","docx","xls","xslx"],o=20971520;$(".drop").each(function(){function r(e){}function a(e,t,o){if(4==e.target.readyState)if(200==e.target.status){upload_count++;var r=parseInt(upload_count/files_count*100);i.text("Загрузка: "+r+"%"),upload_count>=files_count?i.text("Загрузка успешно завершена!"):t[o+1]&&n(t,o+1);var a=JSON.parse(e.target.responseText);d.find(".drop__file_list").append(a.data)}else i.text("Произошла ошибка! Загружено файлов: "+upload_count),i.addClass("drop__zone--error")}function n(e,t){var o=new XMLHttpRequest,n=e[t];o.upload.addEventListener("progress",r,!1),o.onreadystatechange=function(o){a(o,e,t)},o.open("POST","/admin/ajax/upload"),o.setRequestHeader("X-FILE-NAME",encodeURIComponent(n.name));var i=new FormData;i.append("file",n),i.append("field",d.attr("data-field")),i.append("model",d.attr("data-model")),i.append("id",d.attr("data-id")),i.append("_token",$('meta[name="csrf-token"]').attr("content")),o.send(i)}var d=$(this),i=d.find(".drop__zone");return"undefined"==typeof window.FileReader?(i.text("Не поддерживается браузером!"),i.addClass("drop__zone--undefined"),!1):(i[0].ondragover=function(){return i.addClass("drop__zone--hover"),!1},i[0].ondragleave=function(){return i.removeClass("drop__zone--hover"),!1},void(i[0].ondrop=function(r){r.preventDefault(),i.removeClass("drop__zone--hover"),i.removeClass("drop__zone--error"),i.addClass("drop__zone--drop");var a=r.dataTransfer.files;files_count=a.length,upload_count=0;for(var d=0;d<a.length;d++){if(a[d].size>o)return i.html("Один или несколько файлов слишком большие! Ограничение "+Math.floor(o/1024/1024)+"&nbsp;Мб"),i.addClass("drop__zone--error"),!1;var l=e(a[d].name);if(!my.in_array(l,t))return i.text("Данный тип файлов запрещен!"),i.addClass("drop__zone--error"),!1}i.text("Загрузка: 0%"),n(a,0)}))}),$(".drop__file_list").on("click",".drop__file_item_del",function(e){e.preventDefault();var t=$(this),o=t.parents(".drop__file_item:first"),r=o.attr("data-id");return my.post("/admin/ajax/delete",{id:r},function(e){0==e.error&&o.remove()},"json"),!1})}),$(window).on("load",function(){});
"use strict";$(document).ready(function(){$("body").on("click","#ufields__add",function(){var e=$(".ufields__item--gag").clone().removeClass("ufields__item--gag");$(".ufields__item:last").parents("form:first").after(e)}),$("body").on("click",".ufields__save",function(){var e=$(this),i=e.parents(".ufields__item:first"),t=e.parents(".ufields:first"),d=i.attr("data-id"),a=t.attr("data-id"),s=e.parents("form:first"),n="/admin/fields/create/"+a;d>0&&(n="/admin/fields/update/"+d),s.ajaxSubmit({type:"POST",dataType:"json",url:n,success:function(e){if(e.error>0)alert(e.data);else{var i=$(e.data).find(".ufields__form--changed");s.replaceWith(i),$(".ufields__form--changed").removeClass("ufields__form--changed"),$(".ufields__sign").fadeIn(function(){setTimeout(function(){$(".ufields__sign").fadeOut(function(){$(".ufields__sign").remove()})},1200)})}},error:function(){alert("Сервер временно не доступен, обновите страницу и попробуйте снова")}})}),$("body").on("click",".ufields__delete",function(){var e=$(this),i=e.parents(".ufields__item:first"),t=i.attr("data-id");t>0?confirm("Вы точно хотите удалить поле?")&&$.get("/admin/fields/delete/"+t,function(e){e.error>0?alert(e.data):$("#ufields").replaceWith(e.data)}):i.remove()}),$("body").on("click",".ufields__change",function(){var e=$(this),i=e.parents(".ufields__item:first");e.hide(),i.find(".ufields__input input").removeAttr("disabled"),i.find(".ufields__delete").show()})}),$(window).on("load",function(){});
"use strict";$(function(){$(".table__row_delete").on("click",function(){return!!confirm("Вы точно хотите удалить объект?")}),$(".table__check_all").on("click",function(){var e=$(this),t=$(".table__checkbox");e.is(":checked")?t.attr("checked","checked"):t.removeAttr("checked")}),$(".table__multi_delete").on("click",function(){var e=$(this),t=$(".table__checkbox:checked");if(0==t.length)my.alert("Нужно отметить хотябы один объект");else if(confirm("Вы точно хотите удалить выбранные объекты?")){var o=[];t.each(function(){o.push($(this).parents("tr:first").attr("data-id"))}),my.post(e.attr("data-route"),{objects:o},function(e){e.error?alert(e.error):t.each(function(){$(this).parents("tr:first").remove()})},"json")}return!1}),$(".table__row_eye").on("click",function(){var e=$(this),t=e.parents("tr:first");my.post(e.attr("data-route"),{objects:[t.attr("data-id")]},function(t){t.error||(e.hasClass("glyphicon-eye-open")?e.removeClass("glyphicon-eye-open").addClass("glyphicon-eye-close"):e.removeClass("glyphicon-eye-close").addClass("glyphicon-eye-open"))},"json")}),$(".table__multi_active").on("click",function(){var e=$(this),t=$(".table__checkbox:checked");if(0==t.length)my.alert("Нужно отметить хотябы один объект");else{var o=[];t.each(function(){o.push($(this).parents("tr:first").attr("data-id"))}),my.post(e.attr("data-route"),{objects:o},function(e){e.error||t.each(function(){var e=$(this).parents("tr:first").find(".table__row_eye");e.hasClass("glyphicon-eye-open")?e.removeClass("glyphicon-eye-open").addClass("glyphicon-eye-close"):e.removeClass("glyphicon-eye-close").addClass("glyphicon-eye-open")})},"json")}return!1}),$(".table__row").on("dblclick",function(e){var t=$(this),o=t.attr("data-edit");o&&(location.href=o)}),$(".pagination__count select").on("change",function(){var e=$(this);location.href=e.val()})});
"use strict";$(document).ready(function(){$(".dd").nestable({expandBtnHTML:'<button data-action="expand"><i class="fa fa-fw fa-plus"></i></button>',collapseBtnHTML:'<button data-action="collapse"><i class="fa fa-fw fa-minus"></i></button>',onEndEvent:function(){var t=$(this),a=t.attr("data-id"),e=t.parents("li:first"),n=t.prev(".dd-item"),i=0,o=0;e.length&&(i=e.attr("data-id"),$.cookie("admin_pages["+i+"]","1",{path:"/"})),n.length&&(o=n.attr("data-id")),$.post("/admin/pages/position",{id:a,parent_id:i,before_id:o},function(t){t.error&&alert(t.error.text)},"json")}}),$(".tree .eye_btn").on("click",function(t){t.preventDefault();var a=$(this),e=a.parents(".dd-item:first"),n=e.attr("data-id");$.post("/admin/pages/active",{objects:[n]},function(t){t.error?alert(t.error.text):a.hasClass("glyphicon-eye-open")?a.removeClass("glyphicon-eye-open").addClass("glyphicon-eye-close"):a.removeClass("glyphicon-eye-close").addClass("glyphicon-eye-open")},"json")}),$(".tree").on("click",'button[data-action="collapse"]',function(){var t=$(this),a=t.parents(".dd-item").attr("data-id");$.cookie("admin_pages["+a+"]","",{path:"/"})}),$(".tree").on("click",'button[data-action="expand"]',function(){var t=$(this),a=t.parents(".dd-item").attr("data-id");$.cookie("admin_pages["+a+"]","1",{path:"/"})});$.cookie("admin_pages")||[];$(".tree .dd-item").each(function(){var t=$(this),a=t.attr("data-id");if(!$.cookie("admin_pages["+a+"]")){var e=t.find('button[data-action="collapse"]:first');e.length&&e.click()}})});